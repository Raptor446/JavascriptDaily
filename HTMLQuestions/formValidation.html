<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure Signup Form</title>
</head>
<body>
  <h2>Sign Up Form</h2>

  <form id="signupForm">
    <label>
      Username:
      <input type="text" id="username" required minlength="3">
    </label>

    <label>
      Email:
      <input type="email" id="email" required>
    </label>

    <label>
      Password:
      <input type="password" id="password" required minlength="6">
    </label>
    <p id="passwordStrength"></p>

    <button type="submit">Sign Up</button>
  </form>

  <p id="errorMsg"></p>
  <p id="successMsg"></p>

  <!-- CryptoJS for hashing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>

  <script>
    const form = document.getElementById("signupForm")
    const errorMsg = document.getElementById("errorMsg")
    const successMsg = document.getElementById("successMsg")
    const passwordInput = document.getElementById("password")
    const passwordStrength = document.getElementById("passwordStrength")

    // 🔹 Real-time password strength check
    passwordInput.addEventListener("input", () => {
      const value = passwordInput.value
      let strength = "Weak"
      let color = "red"

      if (value.length >= 6 && /[0-9]/.test(value) && /[A-Z]/.test(value) && /[^a-zA-Z0-9]/.test(value)) {
        strength = "Strong"
        color = "green"
      } else if (value.length >= 6 && (/[0-9]/.test(value) || /[A-Z]/.test(value))) {
        strength = "Medium"
        color = "orange"
      }

      passwordStrength.textContent = `Password strength: ${strength}`
      passwordStrength.style.color = color
    })

    // 🔹 Form validation + submission
    form.addEventListener("submit", async function(event) {
      event.preventDefault()

      const username = document.getElementById("username").value.trim()
      const email = document.getElementById("email").value.trim()
      const password = passwordInput.value.trim()

      // Validation
      if (username.length < 3) {
        errorMsg.textContent = "❌ Username must be at least 3 characters."
        successMsg.textContent = ""
        return
      }
      if (!email.includes("@")) {
        errorMsg.textContent = "❌ Invalid email address."
        successMsg.textContent = ""
        return
      }
      if (password.length < 6) {
        errorMsg.textContent = "❌ Password must be at least 6 characters."
        successMsg.textContent = ""
        return
      }

      errorMsg.textContent = ""

      // 🔒 Hash password before sending
      const hashedPassword = CryptoJS.SHA256(password).toString()

      try {
        const response = await fetch("https://jsonplaceholder.typicode.com/posts", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ username, email, password: hashedPassword })
        })

        const data = await response.json()
        console.log("Server response:", data)

        successMsg.textContent = "✅ Form submitted successfully!"
      } catch (err) {
        errorMsg.textContent = "❌ Something went wrong. Try again."
      }
    })
  </script>
</body>
</html>
